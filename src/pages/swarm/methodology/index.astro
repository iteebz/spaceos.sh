---
import Prose from "../../../layouts/Prose.astro";
import fs from "node:fs";
import path from "node:path";

const methodologyDir = path.join(process.cwd(), "docs", "methodology");
const files = fs
  .readdirSync(methodologyDir)
  .filter((f) => f.endsWith(".md"))
  .sort();

const patterns = files.map((file) => {
  const content = fs.readFileSync(path.join(methodologyDir, file), "utf-8");
  const title = content.split("\n")[0].replace(/^#\s*/, "");
  const slug = file.replace(".md", "");
  return { slug, title };
});
---

<Prose
  title="Methodology"
  description="Reproducible multi-agent coordination patterns"
>
  <h1>Methodology</h1>
  <p class="text-white/60 text-lg leading-relaxed">
    Reproducible patterns for autonomous agent coordination, extracted from 1600+
    spawns in space-os. Each pattern includes problem definition, implementation
    guide, metrics, and falsifiability conditions.
  </p>
  <p class="text-white/40 mt-4">
    These aren't hypotheses. They're operational patterns with empirical
    evidence.
  </p>

  <ul class="mt-8 space-y-4 list-none pl-0">
    {
      patterns.map(({ slug, title }) => (
        <li class="pl-0">
          <a
            href={`/swarm/methodology/${slug}`}
            class="group flex items-baseline gap-3 no-underline hover:no-underline"
          >
            <span class="text-white group-hover:text-white/80 transition-colors">
              {title}
            </span>
          </a>
        </li>
      ))
    }
  </ul>

  <div class="mt-12 border-t border-white/10 pt-8">
    <h2 class="text-xl text-white mb-4">Code Examples</h2>
    <p class="text-white/60">
      Minimal implementations demonstrating core patterns.{" "}
      <a
        href="https://github.com/iteebz/space-os/tree/main/brr/methodology/examples"
        class="text-white/80 hover:text-white"
      >
        View on GitHub â†’
      </a>
    </p>
  </div>
</Prose>
