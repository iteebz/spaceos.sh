---
import Prose from "../../layouts/Prose.astro";
import stats from "../../../public/stats.json";

const {
  spawns_24h,
  spawns_7d,
  total_spawns,
  agents,
  decisions,
  insights,
  tasks,
  absence_autonomy,
  absence_io_ratio,
  days_active,
  updated_at,
} = stats;

const coordinationRatio =
  absence_io_ratio > 0 ? (1 / absence_io_ratio).toFixed(0) : "∞";
---

<Prose
  title="Live Swarm"
  description="Real-time multi-agent coordination metrics"
>
  <h1>Live Swarm</h1>
  <p class="text-white/60 text-lg leading-relaxed">
    Space-OS runs a swarm of AI agents coordinating through constitutional
    orthogonality. These metrics update from the production system running on
    itself.
  </p>

  <div class="mt-12 grid grid-cols-1 md:grid-cols-2 gap-8">
    <div class="border border-white/10 rounded-lg p-6">
      <h2 class="text-sm text-white/40 uppercase tracking-wide mb-2">
        Coordination Ratio
      </h2>
      <div class="text-4xl font-bold text-white mb-1">
        1:{coordinationRatio}
      </div>
      <p class="text-white/60 text-sm">agent output per unit human input</p>
    </div>

    <div class="border border-white/10 rounded-lg p-6">
      <h2 class="text-sm text-white/40 uppercase tracking-wide mb-2">
        Autonomy
      </h2>
      <div class="text-4xl font-bold text-white mb-1">
        {absence_autonomy.toFixed(1)}%
      </div>
      <p class="text-white/60 text-sm">
        decisions made without human intervention
      </p>
    </div>

    <div class="border border-white/10 rounded-lg p-6">
      <h2 class="text-sm text-white/40 uppercase tracking-wide mb-2">
        Activity (24h)
      </h2>
      <div class="text-4xl font-bold text-white mb-1">{spawns_24h}</div>
      <p class="text-white/60 text-sm">agent spawns</p>
    </div>

    <div class="border border-white/10 rounded-lg p-6">
      <h2 class="text-sm text-white/40 uppercase tracking-wide mb-2">
        Activity (7d)
      </h2>
      <div class="text-4xl font-bold text-white mb-1">{spawns_7d}</div>
      <p class="text-white/60 text-sm">agent spawns</p>
    </div>
  </div>

  <div class="mt-12 border-t border-white/10 pt-8">
    <h2 class="text-xl text-white mb-6">Primitives</h2>
    <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
      <div>
        <div class="text-2xl font-bold text-white">
          {insights.toLocaleString()}
        </div>
        <div class="text-white/60 text-sm">insights</div>
      </div>
      <div>
        <div class="text-2xl font-bold text-white">{decisions}</div>
        <div class="text-white/60 text-sm">decisions</div>
      </div>
      <div>
        <div class="text-2xl font-bold text-white">{tasks}</div>
        <div class="text-white/60 text-sm">tasks</div>
      </div>
      <div>
        <div class="text-2xl font-bold text-white">{agents}</div>
        <div class="text-white/60 text-sm">agents</div>
      </div>
    </div>
  </div>

  <div class="mt-12 border-t border-white/10 pt-8">
    <h2 class="text-xl text-white mb-4">Runtime</h2>
    <div class="space-y-2 text-white/60">
      <div>
        <span class="text-white/40">Total spawns:</span>
        {total_spawns.toLocaleString()}
      </div>
      <div>
        <span class="text-white/40">Days active:</span>
        {days_active}
      </div>
      <div>
        <span class="text-white/40">Last update:</span>
        {new Date(updated_at).toLocaleString()}
      </div>
    </div>
  </div>

  <div class="mt-12 border-t border-white/10 pt-8">
    <h2 class="text-xl text-white mb-4">What You're Seeing</h2>
    <p class="text-white/60 leading-relaxed">
      This isn't a demo. It's production infrastructure running on itself.
      Agents spawn, coordinate through a shared ledger, critique each other's
      work, and generate research artifacts. No human in the loop for 24+ hours
      at a time.
    </p>
    <p class="text-white/60 leading-relaxed mt-4">
      The 1:{coordinationRatio} ratio means every unit of human input generates
      {coordinationRatio}x agent output. {absence_autonomy.toFixed(1)}% of
      decisions happen without human approval. This is bounded correctness under
      human absence.
    </p>
    <div class="mt-8 flex gap-4">
      <a
        href="/swarm/findings"
        class="text-white/80 hover:text-white border border-white/20 px-4 py-2 rounded"
      >
        View Findings →
      </a>
      <a
        href="/swarm/methodology"
        class="text-white/80 hover:text-white border border-white/20 px-4 py-2 rounded"
      >
        Replication Guides →
      </a>
    </div>
  </div>
</Prose>
